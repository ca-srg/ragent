# ローカル OpenSearch 環境のセットアップ手順

## 概要
RAGent でローカルの OpenSearch を動かすための手順です。

## 手順

### 1. OpenSearch コンテナの起動

Makefile に既にローカル開発用のターゲットが用意されています：

```bash
# OpenSearch を起動
make opensearch-start

# 起動状態を確認
make opensearch-status
```

これにより以下の設定で Docker コンテナが起動します：
- ポート: 9200 (HTTP), 9600 (Performance Analyzer)
- セキュリティプラグイン: 無効
- 管理パスワード: `Admin_123456`

### 2. 環境変数の設定

`.env` ファイルに以下を追加：

```env
# OpenSearch Configuration (LOCAL)
OPENSEARCH_ENDPOINT=http://localhost:9200
OPENSEARCH_INDEX=ragent-documents
OPENSEARCH_REGION=us-east-1
OPENSEARCH_INSECURE_SKIP_TLS=true
```

**重要**: `OPENSEARCH_REGION` はローカルでも必須です（デフォルト値 `us-east-1` が設定されていますが、バリデーションで必要）。

### 3. 利用可能な Make ターゲット

| コマンド | 説明 |
|----------|------|
| `make opensearch-start` | コンテナ起動 |
| `make opensearch-stop` | コンテナ停止・削除 |
| `make opensearch-restart` | 再起動 |
| `make opensearch-logs` | ログ表示 |
| `make opensearch-status` | 状態確認 |

### 4. 動作確認

```bash
# OpenSearch が起動しているか確認
curl http://localhost:9200

# RAGent を実行
go run main.go vectorize
```

## 関連ファイル

- `Makefile` - OpenSearch Docker コマンド定義
- `.env.example` - 環境変数のサンプル
- `internal/types/types.go:126-138` - OpenSearch 設定の型定義
- `internal/config/config.go:164-249` - 設定バリデーション
