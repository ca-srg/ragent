name: Auto-tag on main

on:
  push:
    branches: [ main ]

permissions:
  contents: write

concurrency:
  group: autotag-${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  autotag:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout (full history)
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Bump version and push tag
        id: tagger
        uses: anothrNick/github-tag-action@1.64.0
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          DEFAULT_BUMP: patch   # fallback when commit messages don't specify bump
          WITH_V: "true"        # produce tags like v1.2.3

